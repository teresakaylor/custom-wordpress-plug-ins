document.addEventListener("DOMContentLoaded", function () {
    let spinabot = document.querySelector('.wp-block-button__link[href*="spin-a-bot"]');
    let chatNow = document.querySelector('#chat-now');

    if (!spinabot) return; // If the Spin-a-Bot button doesn't exist, do nothing

    function checkScroll() {
        let scrollY = window.scrollY + window.innerHeight;

        // If #chat-now exists, only show Spin-a-Bot 10% further past its position
        if (chatNow) {
            let chatNowPosition = chatNow.getBoundingClientRect().top + window.scrollY;
            let pageHeight = document.documentElement.scrollHeight;

            // Push the reveal trigger to 10% further down
            let chatNowTrigger = chatNowPosition + (pageHeight * 0.1);

            if (scrollY > chatNowTrigger) {
                spinabot.style.display = "block";
            }
        } 
        // If #chat-now is NOT on the page, fallback to 50% scroll rule
        else {
            let pageHeight = document.documentElement.scrollHeight;
            if (scrollY > pageHeight / 2) {
                spinabot.style.display = "block";
            }
        }
    }

    window.addEventListener("scroll", checkScroll);
});
